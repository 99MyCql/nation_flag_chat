<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>我们都是升旗手</title>
  <link href="https://cdn.bootcss.com/animate.css/3.7.2/animate.min.css" rel="stylesheet">
  <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
  <!-- <link rel="stylesheet" href="{{ url_for('static', filename='css/animate.min.css') }}"> -->
</head>
<style type="text/css">
/* body */
body {
  margin: 0px;
  font: 14px "Lucida Grande", Helvetica, Arial, sans-serif;
}
/* 加载 */
.loading{
  width:100%;
  height: 100%;
  position: fixed;
  top:0;
  left: 0;
  z-index: 1000;
  background-color: #ff0000;
}
.loading .pic{
  width: 150px;
  height: 150px;
  /* background: url(images/loading.gif); */
  position: absolute;
  top: 0;
  bottom: 0;
  left:0;
  right:0;
  margin: auto;
}
.loading .pic i{
  display: block;
  float: left;
  width: 20px;
  height: 150px;
  background: #ffffff;
  margin: 0 2px;
  transform: scaleY(0.4);
  animation: load 1.2s infinite;
}
.loading .pic i:nth-child(1){animation-delay:0.1s }
.loading .pic i:nth-child(2){animation-delay:0.2s }
.loading .pic i:nth-child(3){animation-delay:0.3s }
.loading .pic i:nth-child(4){animation-delay: 0.4s}
.loading .pic i:nth-child(5){animation-delay:0.5s }
@keyframes load {
  0%,40%,100%{transform: scaleY(0.4)}
  20%{transform:scaleY(1) }
}

.bg {
  position: absolute;
  width:100%;
  height:100%;
}
.none {
  display: none;
}
#title {
  z-index: 10;
  position: absolute;
  top: 25%;
  left: 25%;
  width: 50%;
}
.card {
  box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);
  position: absolute;
  top: 40%;
  left: 15%;
  width: 70%;
  z-index: 10;
}
#result {
  z-index: 10;
  position: absolute;
  top: 60%;
  width: 100%;
  text-align: center;
  font-size: 5.5vw;
  color: #faef00;
  font-family: Microsoft Yahei;
}
#add1 {
  position: absolute;
  top: 57%;
  left: 45%;
}
.abso {
  position: absolute;
}
.none {
  display: none;
}
/* img{
  pointer-events:none;
  -webkit-pointer-events:none;
  -ms-pointer-events:none;
  -moz-pointer-events:none;
} */
</style>

<body>
  <script>
  document.onreadystatechange=function(){
    console.log(document.readyState);
    if(document.readyState=="complete") {
      // 播放音乐
      let bgm = new Audio('http://qiniuyun.dounine.live/sound/china.mp3');
      bgm.play();
      bgm.addEventListener('ended', function(e){
        bgm.play();
      });
      // 加载页面退出
      $(".loading").fadeOut();
    }
  }
  </script>
  <div class="loading">
    <div class="pic">
    <i></i>
    <i></i>
    <i></i>
    <i></i>
    <i></i>
    </div>
  </div>
  <!-- loading -->

  <img src="http://qiniuyun.dounine.live/raise_flag/bg2.gif" class="bg">

  <div id="s1">
    <img class="bg" src="http://qiniuyun.dounine.live/raise_flag/bg1.png">
    <img class="abso resize" src="http://qiniuyun.dounine.live/raise_flag/btn.png" style="width: 50px;height: 50px;bottom: 20px;right: 10px;">
    <div class="abso resize" id="btn" style="width: 50px;height: 50px;bottom: 20px;right: 10px;"></div>
    <img class="abso resize" id="flag" src="http://qiniuyun.dounine.live/raise_flag/flag.jpg", style="width: 80px;height: 50px;top: 220px;left: 152px;">
  </div>

  <div id="s2" class="none bg animated fadeIn delay-1s slower">
    <img src="http://qiniuyun.dounine.live/raise_flag/bg3.png" class="bg">
    <img id="title" src="http://qiniuyun.dounine.live/raise_flag/title.png">
    <img src="http://qiniuyun.dounine.live/raise_flag/card.png" class="card">
    <img id="add1" src="http://qiniuyun.dounine.live/raise_flag/add1.png" class="animated fadeOutUp delay-3s slower">
    <div id="result">
      <b>我是第 <span id="count">25666</span> 个升旗手</b>
    </div>
  </div>

  <!-- <div style="display: flex;align-items: center;background-color: white;position: fixed;top:0;bottom: 0;width: 100%;">
    <video autoplay="autoplay" style="width: 100%;">
      <source src="http://qiniuyun.dounine.live/%E5%8D%87%E5%9B%BD%E6%97%97.mp4" type="video/mp4" >
    </video>
  </div> -->

  <!-- <img class="abso resize" src="/static/img/flag_bg2.jpg" style="width: 320px;height: 500px;">
  <div class="abso resize" style="font-size: 26px;top: 120px;left: 85px;color: yellow;text-align: center;">
    五星红旗
    <br>
    你是我的骄傲
  </div> -->

<script type="text/javascript">
// $('#button').one('click', e => {
//   $('#bg').removeClass('none');
//   $('#bg2').removeClass('red');
//   $('#button').removeClass('animated');
//   $('#result').removeClass('none');
//   $('#add1').removeClass('none');
//   let old = parseInt($('#count').html());
//   $('#count').html(old+1);
// })
$(function() {
  // 自适应：源代码中需要以320px宽、500px高为标准进行设置
  scaleW = window.innerWidth/320;
  scaleH = window.innerHeight/500;
  console.log(window.innerWidth, window.innerHeight);

  var resizes = document.querySelectorAll('.resize');

  for (let j=0; j<resizes.length; j++) {
    console.log(parseInt(resizes[j].style.width))
    resizes[j].style.width=parseInt(resizes[j].style.width)*scaleW+'px';
    resizes[j].style.height=parseInt(resizes[j].style.height)*scaleH+'px';

    resizes[j].style.top=parseInt(resizes[j].style.top)*scaleH+'px';
    resizes[j].style.left=parseInt(resizes[j].style.left)*scaleW+'px';
    resizes[j].style.bottom=parseInt(resizes[j].style.bottom)*scaleH+'px';
    resizes[j].style.right=parseInt(resizes[j].style.right)*scaleW+'px';

    resizes[j].style.fontSize=parseInt(resizes[j].style.fontSize)*scaleW+'px';
    resizes[j].style.lineHeight=parseInt(resizes[j].style.lineHeight)*scaleH+'px';
  }

  // 点击升旗按钮
  let timer;
  $('#btn').on({
    touchstart: function(e){
      console.log('touchstart');
      timer = setInterval(function() {
        let flag = document.getElementById('flag');
        let top = parseInt(flag.style.top);
        console.log(top);
        if (top <= 90) {
          clearInterval(timer); //终止定时器
          $('#s1').addClass('none');
          $('#s2').removeClass('none');
          return;
        }
        flag.style.top = top - 2 + 'px';
        console.log(flag.style.top);
      }.bind(this), 20);
    },
    touchmove: function(){
      console.log('touchmove');
      clearInterval(timer); //终止定时器
    },
    touchend: function(e){
      clearInterval(timer); //终止定时器
    }
  })
})
</script>
</body>
</html>